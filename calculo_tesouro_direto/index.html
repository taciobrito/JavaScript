<!DOCTYPE html>
<html>
<head>
	<title>Tesouro Direto x Poupança</title>

	<link rel="stylesheet" type="text/css" href="estilo.css">

<script type="text/javascript" src="jquery.min.js"></script>
</head>
<body>

<div class="geral">

	<div class="div">
	<h3>Simulador - Tesouro Direto x Poupança</h3>

		<form class="calcular">
			<fieldset>
				<legend>Digite os dados do formulário</legend>
				
				<div class="grid_metade">
					<label for="valor_inicial">Valor inicial (R$)</label>
					<input type="number" class="valor_inicial" value="0" />
				</div>

				<div class="grid_metade">
					<label for="valor">Valor mensal (R$)</label>
					<input type="number" class="valor" value="0" />
				</div>
				
			<!-- 	<label>Forma de investimento</label>
				<select class="tipo" size="2">
					<option value="mes" selected>POR MÊS</option>
					<option value="fixo">VALOR FIXO</option>
				</select> -->

				<div class="grid_metade">
					<label for="valor_inicial">Taxa ao ano (a.%)</label>
					<input type="number" class="taxa_anual" value="0" />
				</div>

				<div class="periododiv grid_metade">
					<label for="periodo">Período (Mensal)</label>
					<input type="number" class="periodo" value="0" />
				</div>

				<button type="submit" style="margin-top: 10px;">Calcular</button>
			</fieldset>

		</form>

	</div>

	<div class="div">
		<button type="button">Limpar Resultado</button>
		<h4>Resultado:</h4>
		<div class="resultado"></div>

		<table class="table detalhes">
		<tr>
			<th colspan="3">Detalhes</th>
		</tr>
			<tr>
				<th>Período</th>
				<th>Tesouro Direto</th>
				<th>Poupança</th>
			</tr>
		</table>

	</div>

</div>

<div class="footer">
	<h4>Desenvolvido por: Tácio Brito</h4>
</div>

<script>

	var valor, periodo, valor_inicial, taxa_anual;

	function formataValor( valor ){
		var posicao = valor.toString().indexOf( "." );
		return ( posicao == -1 ) ? "R$ " + valor + ",00" : "R$ " + valor.toString().substring( 0, posicao + 3 ).replace( ".", "," );
	}

	function limparResultado(){
		$( ".linhas" ).remove();
		$( ".resultado p" ).remove();
	}

	function calcular(){

// valor, periodo, valor_inicial, taxa_anual
		limparResultado();

		var total_tesouro = valor + valor_inicial;
		var total_poupanca = valor + valor_inicial;
		var tx_selic = ( taxa_anual / 12 ) / 100;
		var tx_poupanca = 0.5 / 100;

		for( var count = 1; count <= periodo; count++ ){
			if( count != 1 ){
				total_tesouro += valor;
				total_poupanca += valor;
			}

			total_tesouro = total_tesouro + ( total_tesouro * tx_selic );
			total_poupanca = total_poupanca + ( total_poupanca * tx_poupanca );

			$( ".detalhes" ).append( "<tr class='linhas'>" +
										"<td>" + count + "</td>"+
										"<td>" + formataValor( total_tesouro ) + "</td>"+
										"<td>" + formataValor( total_poupanca ) + "</td>"+
									"</tr>" );

			if( count == periodo ){
				$( ".resultado" ).append( "<p>Tesouro: " + formataValor( total_tesouro ) + 
									"<br />Poupança: " + formataValor( total_poupanca )+
									"<br />Diferença: " + formataValor( total_tesouro - total_poupanca ) + "</p>" );
			}
		}
	}
	

	// $(".tipo").on("change", function (){
	// 	tipo = $(".tipo").val();
	// });

	$( ".calcular" ).on( "submit", function(){
		valor = $( ".valor" ).val();
		valor_inicial = $( ".valor_inicial" ).val();
		periodo = $( ".periodo" ).val();
		taxa_anual = $( ".taxa_anual" ).val();

		if( taxa_anual <= 0 ){
			alert( "Informe o valor da taxa anual!" );
		} else if ( periodo == 0 ) {
			alert( "Informe o período de investimento!" );
		} else if( valor < 0 || periodo < 0 || valor_inicial < 0 || taxa_anual < 0 ){
			alert( "Os valores devem ser maiores que 0!" );
		} else {
			calcular( parseFloat( valor ), parseInt( periodo ) );
		}
		return false;
	});

	$( ".div button" ).on( "click", function() {
		limparResultado();
	});

</script>

</body>
</html>