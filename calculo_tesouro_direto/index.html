<!DOCTYPE html>
<html>
<head>
	<title>Tesouro Direto x Poupança</title>

	<link rel="stylesheet" type="text/css" href="estilo.css">


<script type="text/javascript" src="jquery.min.js"></script>
</head>
<body>

<div class="geral">
	

	<div class="div">
	<h3>Simulador - Tesouro Direto x Poupança</h3>

		<form>
			<fieldset>
				<legend>Digite os dados do formulário</legend>
				
				<label for="valor">Valor para investir</label>
				<input type="text" class="valor" />
				
				<label>Invetir</label>
				<select class="tipo" size="2">
					<option value="mes" selected>POR MÊS</option>
					<option value="fixo">VALOR FIXO</option>
				</select>
				<div class="periododiv">
					<label for="periodo">Período de investimento</label>
					<input type="number" class="periodo" />
				</div>

				<button type="button" class="calcular">Calcular</button>
			</fieldset>

		</form>

	</div>

	<div class="div">
		<h3>Resultado</h3>
		<table class="table resultado">
			<tr>
				<th>Período</th>
				<th>Tesouro Direto</th>
				<th>Poupança</th>
			</tr>
		</table>

	</div>

</div>

<div class="footer">
	<h4>Desenvolvido por: Tácio Brito</h4>
</div>

<script>
	function mascaraValor(valor) {
	    valor = valor.toString().replace(/\D/g,"");
	    valor = valor.toString().replace(/(\d)(\d{8})$/,"$1.$2");
	    valor = valor.toString().replace(/(\d)(\d{5})$/,"$1.$2");
	    valor = valor.toString().replace(/(\d)(\d{2})$/,"$1,$2");
	    return valor                    
	}

	function calcular(valor, periodo, tipo){

		$(".resultado tr").remove();

		var total_tesouro = valor; console.log(total_tesouro);
		var total_poupanca = valor; console.log(total_poupanca);
		var tx_selic = 1.18/100; console.log(tx_selic);
		var tx_poupanca = 0.5/100; console.log(tx_poupanca);

		if(tipo == "mes"){
			for(var count = 1; count <= periodo; count++){
				total_tesouro = total_tesouro + (total_tesouro * tx_selic);
				total_poupanca = total_poupanca + (total_poupanca * tx_poupanca);
				$(".resultado").append("<tr>"+
											"<td>" + count + "</td>"+
											"<td>" + mascaraValor(total_tesouro) + "</td>"+
											"<td>" + mascaraValor(total_poupanca) + "</td>"+
										"</tr>");
			}
		}
	}
	
	var valor, periodo;
	var tipo = $(".tipo").val();

	$(".tipo").on("change", function (){
		tipo = $(".tipo").val();
	});

	$(".calcular").on("click", function(){
		valor = $(".valor").val();
		periodo = $(".periodo").val();

		if(valor == 0){
			alert("Informe o valor a ser investido!");
		} else if (periodo == 0){
			alert("Informe o periodo de investimento!");
		} else if(valor < 0 || periodo < 0){
			alert("O valor e o periodo devem ser maiores que 0!");
		} else {
			calcular(valor, periodo, tipo);
		}

	});

</script>

</body>
</html>