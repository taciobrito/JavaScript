<!DOCTYPE html>
<html>
<head>
	<title>Tesouro Direto x Poupança</title>

	<link rel="stylesheet" type="text/css" href="estilo.css">

<script type="text/javascript" src="jquery.min.js"></script>
</head>
<body>

<div class="geral">

	<div class="div">
	<h3>Simulador - Tesouro Direto x Poupança</h3>

		<form class="calcular">
			<fieldset>
				<legend>Digite os dados do formulário</legend>
				
				<label for="valor">Valor para investir</label>
				<input type="text" class="valor" />
				
				<label>Invetir</label>
				<select class="tipo" size="2">
					<option value="mes" selected>POR MÊS</option>
					<option value="fixo">VALOR FIXO</option>
				</select>
				<div class="periododiv">
					<label for="periodo">Período de investimento</label>
					<input type="number" class="periodo" />
				</div>

				<button type="submit">Calcular</button>
			</fieldset>

		</form>

	</div>

	<div class="div">
		<button type="button">Limpar Resultado</button>
		<h4>Resultado:</h4>
		<div class="resultado"></div>

		<table class="table detalhes">
		<tr>
			<th colspan="3">Detalhes</th>
		</tr>
			<tr>
				<th>Período</th>
				<th>Tesouro Direto</th>
				<th>Poupança</th>
			</tr>
		</table>

	</div>

</div>

<div class="footer">
	<h4>Desenvolvido por: Tácio Brito</h4>
</div>

<script>

	function formataValor(valor){
		var posicao = valor.toString().indexOf(".");
		return (posicao == -1) ? "R$ " + valor + ",00" : "R$ " + valor.toString().substring(0, posicao + 3).replace(".", ",");
	}

	function limparResultado(){
		$(".linhas").remove();
		$(".resultado p").remove();
	}

	function calcular(valor, periodo, tipo){

		limparResultado();

		var total_tesouro = valor;
		var total_poupanca = valor;
		var tx_selic = (13.65/12)/100;
		var tx_poupanca = 0.5/100;

		for(var count = 1; count <= periodo; count++){
			if(tipo == "mes" && count != 1){
				total_tesouro += valor;
				total_poupanca += valor;
			}

			total_tesouro = total_tesouro + (total_tesouro * tx_selic);
			total_poupanca = total_poupanca + (total_poupanca * tx_poupanca);

			$(".detalhes").append("<tr class='linhas'>"+
										"<td>" + count + "</td>"+
										"<td>" + formataValor(total_tesouro) + "</td>"+
										"<td>" + formataValor(total_poupanca) + "</td>"+
									"</tr>");

			if(count == periodo){
				$(".resultado").append("<p>Tesouro: " + formataValor(total_tesouro) + 
									"<br />Poupança: " + formataValor(total_poupanca)+
									"<br />Diferença: " + formataValor(total_tesouro - total_poupanca)+"</p>");
			}
		}
	}
	
	var valor, periodo;
	var tipo = $(".tipo").val();

	$(".tipo").on("change", function (){
		tipo = $(".tipo").val();
	});

	$(".calcular").on("submit", function(){

		valor = $(".valor").val();
		periodo = $(".periodo").val();

		if(valor == 0){
			alert("Informe o valor a ser investido!");
		} else if (periodo == 0){
			alert("Informe o periodo de investimento!");
		} else if(valor < 0 || periodo < 0){
			alert("O valor e o periodo devem ser maiores que 0!");
		} else {
			calcular(parseFloat(valor), parseInt(periodo), tipo);
		}
		return false;
	});

	$(".div button").on("click", function(){
		limparResultado();
	});

</script>

</body>
</html>